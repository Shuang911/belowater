import { GoogleMap, Marker, useLoadScript } from "@react-google-maps/api";
import React, { useEffect, useState } from "react";
import { useMemo } from "react";
import "./index.css";
import { getLocation } from "../../../services/api";

const Mapbox = () => {
  const australiaBounds = {
    north: -9.219367,
    south: -44.183799,
    east: 159.287221,
    west: 112.921099,
  };

  const mapStyle = [
    {
      featureType: "water",
      elementType: "geometry",
      stylers: [
        {
          color: "#e9e9e9",
        },
        {
          lightness: 17,
        },
      ],
    },
    {
      featureType: "landscape",
      elementType: "geometry",
      stylers: [
        {
          color: "#9258DC",
        },
        {
          lightness: 20,
        },
      ],
    },
  
  ];



  const [markers, setMarkers] = useState([]);

  const fetchData = async () => {
    try {
      const res = await getLocation();
      const data = res.data;
      const markers = data.map((location) => ({
        name: location.vernacularName,
        category: location.animal_category,
        position: {
          lat: Number(location.latitude),
          lng: Number(location.longitude),
        },
      }));
      setMarkers(markers);

      

    } catch (error) {
      console.error(error);
    }
  };

  useEffect(() => {
    fetchData();
  }, []);

  const mapOptions = {
    styles: mapStyle,
    restriction: {
      latLngBounds: australiaBounds,
      strictBounds: false,
    },
  };

  const customMarker = {
    // path: "M29.395,0H17.636c-3.117,0-5.643,3.467-5.643,6.584v34.804c0,3.116,2.526,5.644,5.643,5.644h11.759   c3.116,0,5.644-2.527,5.644-5.644V6.584C35.037,3.467,32.511,0,29.395,0z M34.05,14.188v11.665l-2.729,0.351v-4.806L34.05,14.188z    M32.618,10.773c-1.016,3.9-2.219,8.51-2.219,8.51H16.631l-2.222-8.51C14.41,10.773,23.293,7.755,32.618,10.773z M15.741,21.713   v4.492l-2.73-0.349V14.502L15.741,21.713z M13.011,37.938V27.579l2.73,0.343v8.196L13.011,37.938z M14.568,40.882l2.218-3.336   h13.771l2.219,3.336H14.568z M31.321,35.805v-7.872l2.729-0.355v10.048L31.321,35.805",
    // path:"M 4 8 L 10 1 L 13 0 L 12 3 L 5 9 C 6 10 6 11 7 10 C 7 11 8 12 7 12 A 1.42 1.42 0 0 1 6 13 A 5 5 0 0 0 4 10 Q 3.5 9.9 3.5 10.5 T 2 11.8 T 1.2 11 T 2.5 9.5 T 3 9 A 5 5 90 0 0 0 7 A 1.42 1.42 0 0 1 1 6 C 1 5 2 6 3 6 C 2 7 3 7 4 8 M 10 1 L 10 3 L 12 3 L 10.2 2.8 L 10 1",
    // src:"data:image/png;base64,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",
    path:"M4.6376.015c-.6714.055-.735.064-1.0476.141-.9084.225-1.545.5324-2.009.97-.271.2576-.5374.6814-.6474 1.03-.0364.116-.0416.149-.0586.344-.0276.2974-.139.524-.419.85-.31.36-.4064.561-.4526.9516-.009.0724.0286.299.061.376.0434.1034.2266.256.395.331.1834.081.456.1084.7376.074.2064-.025.4284-.074.7774-.17.3366-.0924.5324-.1386.7564-.1784.3766-.0676.479-.0774.85-.0774h.35l.2064.0476c.1136.0264.211.0524.216.0576.006.006.0214.165.034.3524.04.5776.07.829.126 1.0536.1074.4324.2576.6764.4774.7764.1116.051.216.0636.3176.039.209-.051.3826-.2174.665-.6384.2266-.335.365-.506.4124-.506.044 0 .091.14.126.375.1534 1.029 1.0024 2.004 1.939 2.231.3286.0786.6584.0626.8316-.0434.0666-.0426.151-.145.1814-.2226.0374-.0976.0464-.296.019-.456-.0114-.065-.06-.241-.109-.3916-.094-.289-.119-.4224-.085-.4626.039-.046.1824.0074.4416.166.775.4764 1.6026 1.395 2.039 2.265.3064.6126.6016 1.44.686 1.9326.035.2.019.4426-.0336.5234-.0336.05-.1.076-.2834.1136-.4764.095-.8536.3064-1.1566.645-.0786.0884-.2026.266-.25.36-.1326.2626-.1976.5816-.1686.821.026.2226.1.356.23.424.141.071.311.0426.5364-.0924.174-.1034.225-.109.3724-.039.0434.02.12.0464.1716.0576.094.0214.1166.0214.5776-.0026.1834-.0086.2726.0074.394.075.105.0586.304.1224.526.1686.1034.0214.2384.0524.3.07.48.1386.8176.3836.9916.719.0586.1126.0884.2064.1326.4064.0586.2676.1616.4174.325.481.109.0416.164.0434.2616.015.119-.0364.174-.0786.25-.195.2726-.4114.4124-1.0216.3474-1.5136-.0676-.509-.211-.8416-.549-1.2624-.336-.424-.7-.7514-1.2524-1.13l-.279-.1926.006-.0576c.004-.0316.019-.1366.0336-.2326.0566-.371.094-.715.1276-1.1626.025-.33.0214-1.5376-.006-1.8874-.1276-1.6114-.414-2.88-.94-4.155-.12-.291-.17-.53-.144-.6864.0276-.1626.0724-.19.379-.2276.289-.035.375-.049.5-.0774.1814-.041.2174-.0914.205-.29-.0214-.365-.3926-.944-.7974-1.2464-.3276-.245-.8636-.495-1.349-.63-.3024-.0836-.4724-.105-.9536-.116-.4124-.01-.7574-.001-1.27.0336l-.3674.025-.545-.2034c-.68-.255-.9284-.3376-1.44-.475-.565-.1534-.99-.2226-1.5926-.2576-.13-.0074-.3064-.0184-.3916-.025-.1784-.015-.529-.014-.715.0026zM6.125.4436c.6176.044.9976.105 1.469.236 1.0584.295 1.955.761 2.7876 1.4524.209.1724.7.6634.8736.8736.5434.654 1.004 1.415 1.26 2.085.0774.206.1484.3574.1566.336.016-.0426-.1586-.619-.28-.921-.254-.6324-.5876-1.23-.981-1.754-.19-.2526-.299-.379-.516-.6-.2124-.2174-.3724-.355-.6236-.535-.205-.146-.311-.245-.305-.2834.0074-.0524.084-.0636.4536-.0636.3386-.001.5334.011.95.056.5224.0576.9334.1474.916.201-.0114.0326-.1716.036-.7226.019-.551-.019-.805-.0134-.879.015l-.035.0134.0224.039c.0326.0576.209.2164.3166.2874.1716.114.301.136.7814.136.6834.0016.97.044 1.2624.19.32.161.5816.4026.5816.5374 0 .045-.061.094-.135.1064-.084.0134-.305.01-.415-.0074-.051-.009-.1616-.0326-.244-.0534-.415-.1034-.56-.036-.5584.259 0 .205.0476.3684.2776.9766.2414.631.61 1.669.686 1.924.0276.094.19.7624.2526 1.044.255 1.1326.3376 2.3784.23 3.456-.0626.6176-.1576 1.0476-.3734 1.6916-.0724.215-.1016.3176-.0914.321.0086.0026.109.029.225.0566.8736.211 1.4476.59 1.7624 1.1614.155.2824.2676.7426.28 1.1514.0086.266-.006.395-.0676.5786-.045.1376-.0914.2174-.1464.2526-.0276.019-.0336.019-.0676.0016-.041-.0214-.054-.0434-.1336-.2516-.109-.2834-.24-.496-.4184-.685-.27-.285-.575-.459-1.07-.609-.4984-.1524-.7834-.345-.811-.55-.015-.1074-.0176-.1126-.0524-.1126-.041 0-.0914.0374-.2474.1876-.0686.065-.1474.13-.175.144-.074.035-.179.0374-.395.0074-.25-.0326-.3084-.0374-.5876-.05-.3276-.015-.385-.045-.4064-.2124-.0114-.0874.0134-.3876.0374-.4676.1-.32.4214-.575.9-.7136.1814-.054.336-.08.6834-.12.1814-.0214.33-.04.3316-.041.005-.004-.0426-.564-.0586-.69-.0434-.3634-.099-.6274-.1814-.8864-.0666-.2034-.0786-.2814-.0464-.291.041-.0134.2864.455.4626.884.0236.0586.0524.1224.064.144l.019.0374.0114-.0316c.0214-.0576.0336-.35.0426-1.0124.0114-.8964.0016-.991-.1686-1.664-.221-.875-.5024-1.5176-.9726-2.2284-.4784-.7226-1.15-1.4416-1.9416-2.0776-.2736-.22-.496-.38-.5274-.38-.03 0 .041.091.276.3564.2736.3074.535.6474.6784.881.0774.1276.285.509.285.525 0 .006-.005.0126-.0114.0126s-.12-.0976-.254-.216c-.4676-.416-.5726-.501-.835-.6774-.3064-.205-.555-.3326-.744-.381-.1024-.0264-.2124-.0326-.224-.0134-.004.006.035.0426.085.081.051.0374.1074.0874.125.1116.099.129.094.3014-.019.6534-.0976.305-.1326.605-.12 1.036.01.3084.026.4466.1034.8226.0826.4026.095.48.096.584.0026.1224-.02.1576-.1474.22-.085.0426-.1.045-.1724.04-.099-.0086-.19-.051-.2964-.1386-.2934-.246-.635-.8924-.904-1.715-.1126-.344-.1626-.5234-.3024-1.081-.235-.9376-.34-1.2024-.5074-1.289-.0264-.0126-.049-.03-.049-.036 0-.064.35-.035.62.0514.0666.0214.1224.036.125.0326.0166-.015-.1434-.1376-.2474-.1876-.335-.165-.951-.3084-1.3226-.3084-.23 0-.7076.0524-.8376.0914l-.0566.0176.05.009c.3034.056.9.339 1.079.511.0614.0586.095.115.0826.1366-.015.0224-.1576.0026-.4426-.065-.425-.1-.6434-.1464-.825-.174-.839-.1266-1.454-.004-2.834.565-.625.2576-.9334.3426-1.21.33-.1524-.006-.215-.0214-.2636-.0636-.03-.025-.0316-.0286-.0126-.0476.025-.0264.145-.0524.3514-.079.3474-.044.5524-.1034.851-.25.3024-.1484.5876-.35.866-.614.129-.1224.201-.214.201-.2566 0-.041-.055-.09-.0986-.089-.0534.0016-.1.0374-.295.234-.089.09-.22.2074-.29.26-.3724.2824-.8236.489-1.2376.5666-.1724.0326-.2424.0134-.3574-.094-.139-.1276-.159-.204-.1016-.366.07-.195.1514-.3216.304-.4724.1716-.1716.3266-.261.545-.319.14-.036.1876-.064.1876-.1074 0-.0224-.0126-.036-.056-.0576-.0914-.0464-.1126-.0786-.1126-.1724 0-.206.181-.5614.4586-.896.06-.0734.221-.25.3574-.3916.135-.14.246-.261.246-.269 0-.015-.109.0264-.2.0774-.225.125-.495.395-.6784.68-.0316.049-.094.1636-.14.2576-.085.175-.125.2276-.165.22-.0714-.0134.0074-.33.1524-.6076.3114-.5986 1.0364-1.085 1.9876-1.3334.4324-.114.761-.159 1.344-.1864.2216-.01 1.1984.005 1.45.0236zM6.3574 3.8876c.1126.0734.2924.2364.3614.3276.116.1524.174.324.2316.6784.1576.98.536 1.9724 1.065 2.79.164.255.225.404.165.404-.096 0-.469-.3166-.7026-.594-.27-.3216-.48-.7824-.615-1.3514-.02-.0826-.085-.4026-.1434-.7126-.0586-.3084-.121-.62-.1386-.6916-.049-.1976-.124-.4036-.209-.57-.0426-.0826-.0924-.1824-.1126-.2236-.0586-.12-.0264-.1386.0986-.0576zM4.8186 4.119c.4784.034.8074.076.956.121.1814.055.369.1814.4724.3166.126.165.1834.3186.2326.6226.025.155.0264.201.0026.1926-.01-.004-.1376-.089-.285-.1876-.501-.34-.7634-.466-1.1786-.565-.4064-.0976-.5776-.11-1.5124-.1126-.44 0-.8216-.006-.8476-.0114-.0514-.0114-.0734-.04-.045-.0586.116-.074.84-.3114 1.0236-.336.116-.0166.87-.004 1.1814.0184zM9.5024 5.586c.36.206.951.7076 1.3274 1.126.345.384.5214.629.6814.9486.189.3766.4536 1.0524.4724 1.2024.0176.1474-.0126.1166-.67-.6814-.1936-.235-.715-.7574-.9876-.9886-.3766-.3216-.6374-.505-.8764-.615-.151-.0714-.196-.1064-.23-.1774-.025-.0534-.026-.0774-.026-.3826 0-.3514.0086-.41.064-.465.0464-.046.1266-.036.245.0326z",
    fillColor: "red",
    fillOpacity: 2,
    strokeWeight: 1,
    rotation: 0,
    scale: 1,
  };

  const { isLoaded } = useLoadScript({
    googleMapsApiKey: "AIzaSyBAPVj00ylUdtRjE3FuA9DWE2YB7xRFaiI",
  });
  const center = useMemo(() => ({ lat: -37.813628, lng: 144.963058 }), []);

  const mapContainerStyle = {
    width: "100%",
    height: "40.31rem",
  };

  return (
    <div className="map">
      {!isLoaded ? (
        <h1>Loading...</h1>
      ) : (
        <GoogleMap
          mapContainerStyle={mapContainerStyle}
          center={center}
          zoom={4}
          options={mapOptions}
        >
          {markers.map((marker,index) => (
            <Marker
              key={index}
              position={{
                lat: Number(marker.position.lat),
                lng: Number(marker.position.lng),
              }}
              icon={customMarker}
              title={marker.category}
            />
          ))}
        </GoogleMap>
      )}
    </div>
  );
};

export default Mapbox;
